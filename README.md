### See branches for different implementations.
